<!--pages/result/result.wxml-->
<view class="container">
  <!-- é€€ä¼‘ä¿¡æ¯ -->
  <view class="card">
    <view class="card-title">é€€ä¼‘ä¿¡æ¯</view>
    <view class="info-grid">
      <view class="info-item">
        <view class="info-label">é€€ä¼‘å¹´é¾„</view>
        <view class="info-value">{{result.retireInfo.displayAge}}</view>
      </view>
      <view class="info-item">
        <view class="info-label">é€€ä¼‘æ—¶é—´</view>
        <view class="info-value">{{result.retireInfo.retireYear}}å¹´{{result.retireInfo.retireMonth}}æœˆ</view>
      </view>
      <view class="info-item">
        <view class="info-label">å‰©ä½™ç¼´è´¹</view>
        <view class="info-value">{{formatMonths(result.retireInfo.monthsToRetire)}}</view>
      </view>
      <view class="info-item">
        <view class="info-label">è®¡å‘æœˆæ•°(N)</view>
        <view class="info-value">{{result.retireInfo.N}}ä¸ªæœˆ</view>
      </view>
    </view>
  </view>

  <!-- å››æ¡£æ–¹æ¡ˆå¯¹æ¯” -->
  <view class="card">
    <view class="card-title">å››æ¡£ç¼´è´¹æ–¹æ¡ˆå¯¹æ¯”</view>
    <view class="plans-container">
      <view wx:for="{{result.plans}}" wx:key="planId" class="plan-card plan-{{item.planId}}">
        <view class="plan-header">
          <view class="plan-name">{{planNames[index]}}</view>
          <view class="plan-badge" wx:if="{{item.planId === result.basePlanIndex}}">æ¨è</view>
        </view>

        <view class="plan-main">
          <view class="plan-pension">
            <text class="pension-amount">{{formatMoney(item.monthlyPension)}}</text>
            <text class="pension-unit">å…ƒ/æœˆ</text>
          </view>
        </view>

        <view class="plan-details">
          <view class="detail-row">
            <text class="detail-label">ç¼´è´¹åŸºæ•°</text>
            <text class="detail-value">{{formatMoney(item.monthlyBase)}}å…ƒ</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">æœˆç¼´è´¹(20%)</text>
            <text class="detail-value">{{formatMoney(item.personalPayPerMonth)}}å…ƒ</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">æ€»ç¼´è´¹</text>
            <text class="detail-value">{{formatMoney(item.totalPersonalPay)}}å…ƒ</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">è´¦æˆ·ä½™é¢</text>
            <text class="detail-value">{{formatMoney(item.finalPersonalAccount)}}å…ƒ</text>
          </view>
          <view class="detail-divider"></view>
          <view class="detail-row highlight">
            <text class="detail-label">åŸºç¡€å…»è€é‡‘</text>
            <text class="detail-value">{{formatMoney(item.basicPensionPart)}}å…ƒ</text>
          </view>
          <view class="detail-row highlight">
            <text class="detail-label">ä¸ªäººè´¦æˆ·</text>
            <text class="detail-value">{{formatMoney(item.accountPensionPart)}}å…ƒ</text>
          </view>

          <view wx:if="{{item.planId > 1}}" class="compare-section">
            <view class="detail-divider"></view>
            <view class="detail-row compare">
              <text class="detail-label">æ¯”åŸºç¡€æ¡£å¤šç¼´</text>
              <text class="detail-value negative">+{{formatMoney(item.deltaPersonalPayVsPlan1)}}å…ƒ</text>
            </view>
            <view class="detail-row compare">
              <text class="detail-label">æ¯æœˆå¤šé¢†</text>
              <text class="detail-value positive">+{{formatMoney(item.deltaMonthlyPensionVsPlan1)}}å…ƒ</text>
            </view>
            <view class="detail-row compare">
              <text class="detail-label">å›æœ¬æ—¶é—´</text>
              <text class="detail-value">{{formatMonths(Math.ceil(item.paybackMonthsVsPlan1))}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ–¹æ¡ˆæ¨è -->
  <view class="card">
    <view class="card-title">æ–¹æ¡ˆæ¨è</view>
    <view class="recommendations">
      <view class="rec-card">
        <view class="rec-icon">âš¡</view>
        <view class="rec-title">å›æœ¬æœ€å¿«æ–¹æ¡ˆ</view>
        <view class="rec-value">{{planNames[result.bestByPayback.planId - 1]}}</view>
        <view class="rec-desc">æœˆå…»è€é‡‘: {{formatMoney(result.bestByPayback.monthlyPension)}}å…ƒ</view>
      </view>

      <view class="rec-card">
        <view class="rec-icon">ğŸ’°</view>
        <view class="rec-title">å…»è€é‡‘æœ€é«˜æ–¹æ¡ˆ</view>
        <view class="rec-value">{{planNames[result.bestByPension.planId - 1]}}</view>
        <view class="rec-desc">æœˆå…»è€é‡‘: {{formatMoney(result.bestByPension.monthlyPension)}}å…ƒ</view>
      </view>
    </view>
  </view>

  <!-- å…»è€é‡‘è®¡ç®—å…¬å¼ -->
  <view class="card">
    <view class="card-title">ğŸ’¡ å…»è€é‡‘è®¡ç®—å…¬å¼è¯´æ˜</view>

    <view class="formula-section">
      <view class="formula-title">æ€»å…¬å¼</view>
      <view class="formula-box">
        æœˆå…»è€é‡‘ = åŸºç¡€å…»è€é‡‘ + ä¸ªäººè´¦æˆ·å…»è€é‡‘
      </view>
    </view>

    <view class="formula-section">
      <view class="formula-title">1ï¸âƒ£ åŸºç¡€å…»è€é‡‘</view>
      <view class="formula-box">
        åŸºç¡€å…»è€é‡‘ = (ç¤¾å¹³å·¥èµ„ + æœ¬äººæŒ‡æ•°åŒ–å·¥èµ„) Ã· 2 Ã— ç¼´è´¹å¹´é™ Ã— 1%
      </view>
      <view class="formula-notes">
        â€¢ ç¤¾å¹³å·¥èµ„ = 12,049å…ƒï¼ˆåŒ—äº¬2025å¹´æ ‡å‡†ï¼‰\n
        â€¢ æœ¬äººæŒ‡æ•°åŒ–å·¥èµ„ = å¹³å‡ç¼´è´¹æŒ‡æ•° Ã— ç¤¾å¹³å·¥èµ„\n
        â€¢ ç¼´è´¹å¹´é™ = ç´¯è®¡ç¼´è´¹æœˆæ•° Ã· 12
      </view>
    </view>

    <view class="formula-section">
      <view class="formula-title">2ï¸âƒ£ ä¸ªäººè´¦æˆ·å…»è€é‡‘</view>
      <view class="formula-box">
        ä¸ªäººè´¦æˆ·å…»è€é‡‘ = é€€ä¼‘æ—¶ä¸ªäººè´¦æˆ·ä½™é¢ Ã· è®¡å‘æœˆæ•°(N)
      </view>
      <view class="formula-notes">
        â€¢ ä¸ªäººè´¦æˆ·ä½™é¢ = å†å²ä½™é¢ + æœªæ¥ç¼´è´¹Ã—8% + åˆ©æ¯\n
        â€¢ è®¡å‘æœˆæ•°(N) = {{result.retireInfo.N}}ä¸ªæœˆï¼ˆ{{result.retireInfo.displayAge}}é€€ä¼‘å¯¹åº”ï¼‰\n
        â€¢ çµæ´»å°±ä¸šäººå‘˜ï¼šæœˆç¼´è´¹Ã—8%è®¡å…¥ä¸ªäººè´¦æˆ·\n
        â€¢ è´¦æˆ·å¹´åˆ©ç‡ï¼š1.5%
      </view>
    </view>

    <view class="formula-section">
      <view class="formula-title">3ï¸âƒ£ çµæ´»å°±ä¸šäººå‘˜ç¼´è´¹æ ‡å‡†</view>
      <view class="formula-box highlight">
        ä¸ªäººæ€»ç¼´è´¹ = ç¼´è´¹åŸºæ•° Ã— 20%\n
        â”œâ”€ 8% è®¡å…¥ä¸ªäººè´¦æˆ·\n
        â””â”€ 12% è¿›å…¥ç»Ÿç­¹è´¦æˆ·
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="btn btn-secondary" bindtap="goBack">é‡æ–°è®¡ç®—</button>
    <button class="btn btn-primary" bindtap="shareResult">åˆ†äº«ç»“æœ</button>
  </view>

  <!-- åº•éƒ¨æç¤º -->
  <view class="footer">
    <view>æ•°æ®æ¥æºï¼šåŒ—äº¬å¸‚äººåŠ›èµ„æºå’Œç¤¾ä¼šä¿éšœå±€ 2025å¹´å…¬å¸ƒæ•°æ®</view>
    <view style="margin-top: 10rpx; color: #f59e0b;">âš ï¸ æœ¬è®¡ç®—ç»“æœä»…ä¾›å‚è€ƒï¼Œå®é™…å…»è€é‡‘ä»¥ç¤¾ä¿éƒ¨é—¨æ ¸å®šä¸ºå‡†</view>
  </view>
</view>
